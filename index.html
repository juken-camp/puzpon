<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Quiz - ä¸­å­¦ç”Ÿå‘ã‘å­¦ç¿’ã‚¯ã‚¤ã‚º</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #f39c12;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --background-color: #f8f9fa;
            --text-color: #2c3e50;
            --border-color: #e9ecef;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .subject-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .subject-card {
            background: white;
            border: 3px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .subject-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 5px 20px rgba(74, 144, 226, 0.3);
        }

        .subject-card .icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .subject-card h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        .category-selection {
            margin-bottom: 30px;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .category-item {
            background: #f8f9fa;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .category-item:hover {
            border-color: var(--primary-color);
            background: #e3f2fd;
        }

        .category-item.selected {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .category-item h4 {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .category-item p {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            font-weight: 600;
        }

        .btn:hover {
            background: #357abd;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 144, 226, 0.4);
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: var(--secondary-color);
        }

        .btn-secondary:hover {
            background: #d68910;
        }

        .btn-success {
            background: var(--success-color);
        }

        .btn-success:hover {
            background: #229954;
        }

        .quiz-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: var(--background-color);
            padding: 10px 15px;
            border-radius: 10px;
            text-align: center;
            min-width: 80px;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .question-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid var(--primary-color);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 500;
            line-height: 1.6;
            margin-bottom: 20px;
            color: var(--text-color);
        }

        .options-container {
            display: grid;
            gap: 15px;
            margin-bottom: 25px;
        }

        .option {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            text-align: left;
        }

        .option:hover {
            border-color: var(--primary-color);
            background: #e3f2fd;
            transform: translateX(5px);
        }

        .option.selected {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 12px;
            min-height: 100px;
        }

        .result.correct {
            background: linear-gradient(135deg, #d5f4e6, #80e5a3);
            border: 2px solid var(--success-color);
        }

        .result.incorrect {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            border: 2px solid var(--danger-color);
        }

        .result h3 {
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .result p {
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .ai-explanation {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
        }

        .ai-explanation h4 {
            margin: 0 0 15px 0;
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .ai-content {
            line-height: 1.6;
            white-space: pre-wrap;
            color: var(--text-color);
        }

        .loading {
            text-align: center;
            padding: 30px;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading p {
            color: var(--primary-color);
            font-weight: 500;
        }

        .audio-controls {
            margin-top: 15px;
            text-align: center;
        }

        .audio-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            margin: 0 5px;
            transition: all 0.3s ease;
        }

        .audio-btn:hover {
            background: #d68910;
        }

        .settings-panel {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings-panel h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .setting-group {
            margin-bottom: 15px;
        }

        .setting-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .back-btn {
            background: #6c757d;
            margin-bottom: 20px;
        }

        .back-btn:hover {
            background: #545b62;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .main-content {
                padding: 20px;
            }

            .subject-grid {
                grid-template-columns: 1fr;
            }

            .quiz-header {
                flex-direction: column;
                align-items: stretch;
            }

            .stats {
                justify-content: center;
            }

            .question-text {
                font-size: 1.1rem;
            }
        }

        .error-message {
            background: #ffe6e6;
            border: 2px solid var(--danger-color);
            color: var(--danger-color);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }

        .success-message {
            background: #e6ffe6;
            border: 2px solid var(--success-color);
            color: var(--success-color);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>âœ¨ Quick Quiz</h1>
            <p>ä¸­å­¦ç”Ÿå‘ã‘å­¦ç¿’ã‚¯ã‚¤ã‚º - AIãŒè©³ã—ãè§£èª¬ã—ã¾ã™</p>
        </div>

        <div class="main-content">
            <!-- æ•™ç§‘é¸æŠã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div id="subject-selection" class="section active">
                <h2>ğŸ“š æ•™ç§‘ã‚’é¸æŠ</h2>
                <p>å­¦ç¿’ã—ãŸã„æ•™ç§‘ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                
                <div class="subject-grid">
                    <div class="subject-card" onclick="selectSubject('social')">
                        <div class="icon">ğŸŒ</div>
                        <h3>ç¤¾ä¼š</h3>
                        <p>åˆ†é‡ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                    <div class="subject-card" onclick="selectSubject('science')">
                        <div class="icon">ğŸ”¬</div>
                        <h3>ç†ç§‘</h3>
                        <p>åˆ†é‡ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                    <div class="subject-card" onclick="selectSubject('english')">
                        <div class="icon">ğŸ“–</div>
                        <h3>è‹±èª</h3>
                        <p>åˆ†é‡ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                </div>
            </div>

            <!-- ç¤¾ä¼šã®åˆ†é‡é¸æŠ -->
            <div id="social-fields" class="section">
                <button class="btn back-btn" onclick="goBack('subject-selection')">â† æˆ»ã‚‹</button>
                <h2>ğŸŒ ç¤¾ä¼š</h2>
                <div class="subject-grid">
                    <div class="subject-card" onclick="selectField('geography')">
                        <div class="icon">ğŸ—ºï¸</div>
                        <h3>åœ°ç†</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                    <div class="subject-card" onclick="selectField('history')">
                        <div class="icon">ğŸ›ï¸</div>
                        <h3>æ­´å²</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                    <div class="subject-card" onclick="selectField('civics')">
                        <div class="icon">âš–ï¸</div>
                        <h3>å…¬æ°‘</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                </div>
            </div>

            <!-- ç†ç§‘ã®åˆ†é‡é¸æŠ -->
            <div id="science-fields" class="section">
                <button class="btn back-btn" onclick="goBack('subject-selection')">â† æˆ»ã‚‹</button>
                <h2>ğŸ”¬ ç†ç§‘</h2>
                <div class="subject-grid">
                    <div class="subject-card" onclick="selectField('chemistry')">
                        <div class="icon">ğŸ§ª</div>
                        <h3>åŒ–å­¦</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                    <div class="subject-card" onclick="selectField('biology')">
                        <div class="icon">ğŸ§¬</div>
                        <h3>ç”Ÿç‰©</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                    <div class="subject-card" onclick="selectField('physics')">
                        <div class="icon">âš›ï¸</div>
                        <h3>ç‰©ç†</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                    <div class="subject-card" onclick="selectField('earth')">
                        <div class="icon">ğŸŒ</div>
                        <h3>åœ°å­¦</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                </div>
            </div>

            <!-- è‹±èªã®åˆ†é‡é¸æŠ -->
            <div id="english-fields" class="section">
                <button class="btn back-btn" onclick="goBack('subject-selection')">â† æˆ»ã‚‹</button>
                <h2>ğŸ“– è‹±èª</h2>
                <div class="subject-grid">
                    <div class="subject-card" onclick="selectField('words')">
                        <div class="icon">ğŸ“</div>
                        <h3>è‹±å˜èª</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                    <div class="subject-card" onclick="selectField('phrases')">
                        <div class="icon">ğŸ’¬</div>
                        <h3>è‹±ç†Ÿèª</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                    <div class="subject-card" onclick="selectField('grammar')">
                        <div class="icon">ğŸ“˜</div>
                        <h3>èªå½¢å¤‰åŒ–</h3>
                        <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>
                </div>
            </div>

            <!-- ã‚«ãƒ†ã‚´ãƒªé¸æŠã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div id="category-selection" class="section">
                <button class="btn back-btn" onclick="goBackToSubject()">â† æˆ»ã‚‹</button>
                <div class="category-selection">
                    <h2 id="category-title">å˜å…ƒã‚’é¸æŠ</h2>
                    <p>å­¦ç¿’ã™ã‚‹å˜å…ƒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚è¤‡æ•°é¸æŠã‚‚ã§ãã¾ã™ã€‚</p>
                    
                    <!-- éŸ³å£°è¨­å®š -->
                    <div id="audio-settings" class="settings-panel" style="display: none;">
                        <h3>ğŸ”Š éŸ³å£°è¨­å®š</h3>
                        <p>è‹±èªã®ç™ºéŸ³è¨­å®šã‚’å¤‰æ›´ã§ãã¾ã™</p>
                        
                        <div class="setting-group">
                            <label>éŸ³å£°å†ç”Ÿ</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="audioEnabled" checked>
                                <span class="slider"></span>
                            </label>
                            <small>è‹±èªã®å•é¡Œã§è‡ªå‹•ç™ºéŸ³ã‚’è¡Œã„ã¾ã™</small>
                        </div>
                        
                        <div class="setting-group">
                            <label>éŸ³å£°ã®ç¨®é¡</label>
                            <div>
                                <label><input type="radio" name="voice" value="female" checked> ğŸ‘© å¥³æ€§éŸ³å£°</label>
                                <label><input type="radio" name="voice" value="male"> ğŸ‘¨ ç”·æ€§éŸ³å£°</label>
                            </div>
                        </div>
                    </div>
                    
                    <div id="category-grid" class="category-grid">
                        <!-- ã‚«ãƒ†ã‚´ãƒªãŒã“ã“ã«å‹•çš„ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-success" onclick="startQuiz()" disabled id="start-btn">
                            ğŸ“‹ å‡ºé¡Œå½¢å¼<br>
                            <small>å•é¡Œã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«å‡ºé¡Œã—ã¾ã™</small>
                        </button>
                    </div>
                </div>
            </div>

            <!-- ã‚¯ã‚¤ã‚ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div id="quiz-section" class="section">
                <div class="quiz-container">
                    <div class="quiz-header">
                        <button class="btn back-btn" onclick="goBack('category-selection')">â† æˆ»ã‚‹</button>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-label">æ­£è§£æ•°</div>
                                <div class="stat-value" id="correct-count">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">ä¸æ­£è§£æ•°</div>
                                <div class="stat-value" id="incorrect-count">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">ç·å•é¡Œæ•°</div>
                                <div class="stat-value" id="total-count">0</div>
                            </div>
                        </div>
                    </div>

                    <div class="question-container">
                        <div class="question-text" id="question-text">
                            å•é¡Œã‚’èª­ã¿è¾¼ã¿ä¸­...
                        </div>
                        
                        <div class="audio-controls" id="audio-controls" style="display: none;">
                            <button class="audio-btn" onclick="speakQuestion()">ğŸ”Š å•é¡Œã‚’èª­ã¿ä¸Šã’</button>
                            <button class="audio-btn" onclick="speakOptions()">ğŸ“ é¸æŠè‚¢ã‚’èª­ã¿ä¸Šã’</button>
                        </div>
                    </div>

                    <div class="options-container" id="options-container">
                        <!-- é¸æŠè‚¢ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                    </div>

                    <div style="text-align: center;">
                        <button class="btn btn-secondary" onclick="nextQuestion()">æ¬¡ã®å•é¡Œ â†’</button>
                    </div>

                    <div id="result" class="result" style="display: none;">
                        <!-- çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- problems.jsã‚’èª­ã¿è¾¼ã¿ -->
    <script src="problems.js"></script>

    <script>
        // è¨­å®š
        const DIFY_API_KEY = 'YOUR_DIFY_API_KEY'; // ã“ã“ã«ã‚ãªãŸã®Dify APIã‚­ãƒ¼ã‚’å…¥åŠ›
        const DIFY_API_URL = 'https://api.dify.ai/v1/chat-messages'; // Dify APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentSubject = '';
        let currentField = '';
        let selectedCategories = [];
        let currentProblems = [];
        let currentProblem = null;
        let currentProblemIndex = 0;
        let stats = {
            correct: 0,
            incorrect: 0,
            total: 0
        };

        // ã‚«ãƒ†ã‚´ãƒªå®šç¾©
        const categoryDefinitions = {
            geography: {
                title: 'ğŸ—ºï¸ åœ°ç†',
                categories: {
                    geo_world_overview: { title: 'ä¸–ç•Œã®å§¿', description: 'å¤§é™¸ãƒ»æµ·æ´‹ãƒ»æ°—å€™ãªã©' },
                    geo_japan_overview: { title: 'æ—¥æœ¬ã®å§¿', description: 'é ˜åœŸãƒ»æ™‚å·®ãƒ»æ¨™æº–æ™‚ãªã©' },
                    geo_world_life: { title: 'ä¸–ç•Œå„åœ°ã®äººã€…ã®ç”Ÿæ´»ã¨ç’°å¢ƒ', description: 'æ°—å€™å¸¯ãƒ»å®—æ•™ãƒ»æ–‡åŒ–ãªã©' },
                    geo_asia: { title: 'ã‚¢ã‚¸ã‚¢å·', description: 'ä¸­å›½ãƒ»ã‚¤ãƒ³ãƒ‰ãƒ»æ±å—ã‚¢ã‚¸ã‚¢ãªã©' },
                    geo_europe: { title: 'ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘å·', description: 'EUãƒ»å·¥æ¥­ãƒ»è¾²æ¥­ãªã©' },
                    geo_africa: { title: 'ã‚¢ãƒ•ãƒªã‚«å·', description: 'æ¤æ°‘åœ°ãƒ»ãƒ¢ãƒã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒ»è³‡æºãªã©' },
                    geo_north_america: { title: 'åŒ—ã‚¢ãƒ¡ãƒªã‚«å·', description: 'ã‚¢ãƒ¡ãƒªã‚«ãƒ»ã‚«ãƒŠãƒ€ãƒ»å·¥æ¥­ãªã©' },
                    geo_south_america: { title: 'å—ã‚¢ãƒ¡ãƒªã‚«å·', description: 'ãƒ–ãƒ©ã‚¸ãƒ«ãƒ»ã‚¢ãƒã‚¾ãƒ³ãƒ»è¾²æ¥­ãªã©' },
                    geo_oceania: { title: 'ã‚ªã‚»ã‚¢ãƒ‹ã‚¢', description: 'ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ãƒ»å¤šæ–‡åŒ–ç¤¾ä¼šãªã©' },
                    geo_japan_features: { title: 'æ—¥æœ¬ã®åœ°åŸŸçš„ç‰¹è‰²', description: 'æ°—å€™ãƒ»ç½å®³ãƒ»ç”£æ¥­ãƒ»äººå£ãªã©' }
                }
            },
            history: {
                title: 'ğŸ›ï¸ æ­´å²',
                categories: {
                    hist_ancient: { title: 'æ–‡æ˜ã®ãŠã“ã‚Šã¨æ—¥æœ¬ã®æˆã‚Šç«‹ã¡', description: 'å››å¤§æ–‡æ˜ãƒ»ç¸„æ–‡ãƒ»å¼¥ç”Ÿæ™‚ä»£ãªã©' },
                    hist_ancient_state: { title: 'å¤ä»£å›½å®¶ã®æ­©ã¿ã¨æ±ã‚¢ã‚¸ã‚¢', description: 'é£›é³¥ãƒ»å¥ˆè‰¯ãƒ»å¹³å®‰æ™‚ä»£ãªã©' },
                    hist_kamakura: { title: 'æ­¦å£«ã®ãŠã“ã‚Šã¨éŒå€‰å¹•åºœ', description: 'æºå¹³åˆæˆ¦ãƒ»åŸ·æ¨©æ”¿æ²»ãªã©' },
                    hist_muromachi: { title: 'ãƒ¢ãƒ³ã‚´ãƒ«ã®è¥²æ¥ã¨å®¤ç”ºå¹•åºœ', description: 'å…ƒå¯‡ãƒ»å—åŒ—æœãƒ»å¿œä»ã®ä¹±ãªã©' },
                    hist_unification: { title: 'ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘äººã¨ã®å‡ºä¼šã„ã¨å…¨å›½çµ±ä¸€', description: 'ç¹”ç”°ãƒ»è±Šè‡£ãƒ»æˆ¦å›½æ™‚ä»£ãªã©' },
                    hist_edo_early: { title: 'æ±Ÿæˆ¸å¹•åºœã®æˆç«‹ã¨é–å›½', description: 'å¾³å·æ”¿æ²»ãƒ»å‚å‹¤äº¤ä»£ãªã©' },
                    hist_edo_develop: { title: 'ç”£æ¥­ã®ç™ºé”ã¨å¹•åºœæ”¿æ²»ã®å±•é–‹', description: 'å…ƒç¦„ãƒ»åŒ–æ”¿æ–‡åŒ–ãƒ»æ”¹é©ãªã©' },
                    hist_opening: { title: 'æ¬§ç±³ã®é€²å‡ºã¨æ—¥æœ¬ã®é–‹å›½', description: 'ãƒšãƒªãƒ¼æ¥èˆªãƒ»æ˜æ²»ç¶­æ–°ãªã©' },
                    hist_meiji: { title: 'æ˜æ²»ç¶­æ–°', description: 'å»ƒè—©ç½®çœŒãƒ»æ–‡æ˜é–‹åŒ–ãƒ»æ†²æ³•ãªã©' },
                    hist_wars: { title: 'æ—¥æ¸…ãƒ»æ—¥éœ²æˆ¦äº‰ã¨æ—¥æœ¬ã®ç”£æ¥­é©å‘½', description: 'æ¡ç´„æ”¹æ­£ãƒ»å¸å›½ä¸»ç¾©ãªã©' },
                    hist_wwi: { title: 'ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ¦ã¨æ—¥æœ¬', description: 'å¤§æ­£ãƒ‡ãƒ¢ã‚¯ãƒ©ã‚·ãƒ¼ãƒ»æ°‘ä¸»åŒ–ãªã©' },
                    hist_wwii: { title: 'ä¸–ç•Œææ…Œã¨ç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ¦', description: 'ãƒ•ã‚¡ã‚·ã‚ºãƒ ãƒ»å¤ªå¹³æ´‹æˆ¦äº‰ãªã©' },
                    hist_postwar: { title: 'æˆ¦å¾Œã®æ—¥æœ¬ã®ç™ºå±•ã¨å›½éš›ç¤¾ä¼š', description: 'æ°‘ä¸»åŒ–ãƒ»é«˜åº¦æˆé•·ãƒ»å†·æˆ¦ãªã©' }
                }
            },
            civics: {
                title: 'âš–ï¸ å…¬æ°‘',
                categories: {
                    civics_modern: { title: 'ç¾ä»£ç¤¾ä¼šã¨ç§ãŸã¡', description: 'ã‚°ãƒ­ãƒ¼ãƒãƒ«åŒ–ãƒ»æƒ…å ±åŒ–ãƒ»å¤šæ–‡åŒ–ãªã©' },
                    civics_constitution: { title: 'äººé–“ã®å°Šé‡ã¨æ—¥æœ¬å›½æ†²æ³•', description: 'äººæ¨©ãƒ»æ†²æ³•ã®åŸç†ãªã©' },
                    civics_democracy: { title: 'ç¾ä»£ã®æ°‘ä¸»æ”¿æ²»', description: 'å›½ä¼šãƒ»å†…é–£ãƒ»è£åˆ¤æ‰€ãƒ»åœ°æ–¹è‡ªæ²»ãªã©' },
                    civics_economy: { title: 'æš®ã‚‰ã—ã¨çµŒæ¸ˆ', description: 'å¸‚å ´çµŒæ¸ˆãƒ»ä¼æ¥­ãƒ»é‡‘èãƒ»è²¡æ”¿ãªã©' }
                }
            },
            chemistry: {
                title: 'ğŸ§ª åŒ–å­¦',
                categories: {
                    chemistry_basic: { title: 'ç‰©è³ªã¨ãã®æ€§è³ª', description: 'æœ‰æ©Ÿç‰©ãƒ»ç„¡æ©Ÿç‰©ãƒ»é‡‘å±ãƒ»å¯†åº¦ãªã©' },
                    chemistry_gas: { title: 'æ°—ä½“ã®æ€§è³ª', description: 'é…¸ç´ ãƒ»äºŒé…¸åŒ–ç‚­ç´ ãƒ»æ°´ç´ ãƒ»ã‚¢ãƒ³ãƒ¢ãƒ‹ã‚¢ãªã©' },
                    chemistry_solution: { title: 'æ°´æº¶æ¶²ã®æ€§è³ª', description: 'æ¿ƒåº¦ãƒ»æº¶è§£åº¦ãƒ»å†çµæ™¶ãªã©' },
                    chemistry_state: { title: 'çŠ¶æ…‹å¤‰åŒ–', description: 'èç‚¹ãƒ»æ²¸ç‚¹ãƒ»è’¸ç•™ãªã©' },
                    chemistry_change: { title: 'ç‰©è³ªã®å¤‰åŒ–', description: 'åˆ†è§£ãƒ»é›»æ°—åˆ†è§£ãƒ»åŒ–å­¦åå¿œå¼ãªã©' },
                    chemistry_structure: { title: 'ç‰©è³ªã®æˆã‚Šç«‹ã¡', description: 'åŸå­ãƒ»åˆ†å­ãƒ»åŒ–å­¦å¼ãƒ»åŒ–å­¦åå¿œå¼ãªã©' },
                    chemistry_reaction: { title: 'ç‰©è³ªã©ã†ã—ã®åŒ–å­¦å¤‰åŒ–', description: 'é…¸åŒ–ãƒ»é‚„å…ƒãƒ»ç‡ƒç„¼ãªã©' },
                    chemistry_mass: { title: 'åŒ–å­¦å¤‰åŒ–ã¨è³ªé‡', description: 'è³ªé‡ä¿å­˜ã®æ³•å‰‡ãƒ»å®šæ¯”ä¾‹ã®æ³•å‰‡ãªã©' },
                    chemistry_ion: { title: 'ã‚¤ã‚ªãƒ³ã¨é›»æ± ', description: 'é›»è§£è³ªãƒ»é›»é›¢ãƒ»é›»æ± ãªã©' },
                    chemistry_acid: { title: 'é…¸ã€ã‚¢ãƒ«ã‚«ãƒªã€å¡©', description: 'pHãƒ»ä¸­å’Œãƒ»æŒ‡ç¤ºè–¬ãªã©' }
                }
            },
            biology: {
                title: 'ğŸ§¬ ç”Ÿç‰©',
                categories: {
                    biology_flower: { title: 'èŠ±ã®ã¤ãã‚Š', description: 'ã‚ã—ã¹ãƒ»ãŠã—ã¹ãƒ»å—ç²‰ãƒ»è¢«å­æ¤ç‰©ãªã©' },
                    biology_plant: { title: 'æ ¹ãƒ»è‘‰ã®ã¤ãã‚Šã€æ¤ç‰©ã®ç‰¹å¾´ã¨åˆ†é¡', description: 'æ ¹ãƒ»è‘‰è„ˆãƒ»å˜å­è‘‰é¡ãƒ»åŒå­è‘‰é¡ãªã©' },
                    biology_animal: { title: 'å‹•ç‰©ã®ç‰¹å¾´ã¨åˆ†é¡', description: 'è„Šæ¤å‹•ç‰©ãƒ»ç„¡è„Šæ¤å‹•ç‰©ãƒ»åˆ†é¡ãªã©' },
                    biology_microscope: { title: 'é¡•å¾®é¡ã®ä½¿ã„æ–¹', description: 'å¯¾ç‰©ãƒ¬ãƒ³ã‚ºãƒ»æ¥çœ¼ãƒ¬ãƒ³ã‚ºãƒ»å€ç‡ãªã©' },
                    biology_cell: { title: 'ç”Ÿç‰©ã¨ç´°èƒ', description: 'ç´°èƒè†œãƒ»æ ¸ãƒ»ç´°èƒå£ãƒ»å˜ç´°èƒç”Ÿç‰©ãªã©' },
                    biology_plant_body: { title: 'æ¤ç‰©ã®ã‹ã‚‰ã ã®ã¤ãã‚Šã€æ¤ç‰©ã¨æ—¥å…‰', description: 'é“ç®¡ãƒ»å¸«ç®¡ãƒ»å…‰åˆæˆãƒ»è’¸æ•£ãªã©' },
                    biology_digestion: { title: 'æ¶ˆåŒ–ã¨å¸å', description: 'æ¶ˆåŒ–é…µç´ ãƒ»å°è…¸ãƒ»æŸ”æ¯›ãªã©' },
                    biology_breathing: { title: 'å‘¼å¸', description: 'è‚ºèƒãƒ»æ¨ªéš”è†œãƒ»å¤–å‘¼å¸ãªã©' },
                    biology_circulation: { title: 'è¡€æ¶²ã®å¾ªç’°ã€æ’å‡ºã®ã—ãã¿', description: 'å¿ƒè‡“ãƒ»è¡€æ¶²ãƒ»è…è‡“ãƒ»è‚è‡“ãªã©' },
                    biology_response: { title: 'åˆºæ¿€ã¨åå¿œã€å‹•ç‰©ã®ã‹ã‚‰ã ', description: 'æ„Ÿè¦šå™¨å®˜ãƒ»ç¥çµŒãƒ»åå°„ãªã©' },
                    biology_growth: { title: 'ç”Ÿç‰©ã®æˆé•·ã¨ç´°èƒã®å¤‰åŒ–', description: 'ç´°èƒåˆ†è£‚ãƒ»æˆé•·ç‚¹ãªã©' },
                    biology_reproduction: { title: 'ç”Ÿç‰©ã®ç”Ÿæ®–', description: 'æœ‰æ€§ç”Ÿæ®–ãƒ»ç„¡æ€§ç”Ÿæ®–ãƒ»å—ç²¾ãƒ»éºä¼ãªã©' },
                    biology_heredity: { title: 'éºä¼ã®è¦å‰‡æ€§ã¨éºä¼å­', description: 'ãƒ¡ãƒ³ãƒ‡ãƒ«ãƒ»å¯¾ç«‹å½¢è³ªãƒ»åˆ†é›¢ã®æ³•å‰‡ãªã©' },
                    biology_evolution: { title: 'ç”Ÿç‰©ã®é€²åŒ–ã€ç”Ÿæ…‹ç³»ã¨é£Ÿç‰©é€£é–', description: 'é€²åŒ–ãƒ»ç›¸åŒå™¨å®˜ãƒ»é£Ÿç‰©é€£é–ãƒ»ç”Ÿæ…‹ç³»ãªã©' },
                    biology_environment: { title: 'è‡ªç„¶ã¨ç’°å¢ƒã€äººé–“ã¨è‡ªç„¶ç’°å¢ƒ', description: 'å¤–æ¥ç¨®ãƒ»åœ°çƒæ¸©æš–åŒ–ãƒ»å†ç”Ÿå¯èƒ½ã‚¨ãƒãƒ«ã‚®ãƒ¼ãªã©' }
                }
            },
            physics: {
                title: 'âš›ï¸ ç‰©ç†',
                categories: {
                    physics_light: { title: 'å…‰ã«ã‚ˆã‚‹ç¾è±¡', description: 'å…‰ã®åå°„ãƒ»å±ˆæŠ˜ãƒ»å‡¸ãƒ¬ãƒ³ã‚ºãªã©' },
                    physics_sound: { title: 'éŸ³ã«ã‚ˆã‚‹ç¾è±¡', description: 'æŒ¯å¹…ãƒ»æŒ¯å‹•æ•°ãƒ»éŸ³ã®é€Ÿã•ãªã©' },
                    physics_force: { title: 'åŠ›ã«ã‚ˆã‚‹ç¾è±¡', description: 'é‡åŠ›ãƒ»å¼¾æ€§åŠ›ãƒ»æ‘©æ“¦åŠ›ãƒ»ãƒ•ãƒƒã‚¯ã®æ³•å‰‡ãªã©' },
                    physics_current: { title: 'é›»æµã¨é›»åœ§', description: 'ç›´åˆ—å›è·¯ãƒ»ä¸¦åˆ—å›è·¯ãƒ»ã‚ªãƒ¼ãƒ ã®æ³•å‰‡ãªã©' },
                    physics_energy: { title: 'é›»æ°—ã‚¨ãƒãƒ«ã‚®ãƒ¼', description: 'é›»åŠ›ãƒ»é›»åŠ›é‡ãƒ»ç™ºç†±é‡ãªã©' },
                    physics_magnetic: { title: 'é›»æµã¨ç£ç•Œ', description: 'ç£ç•Œãƒ»é›»ç£èª˜å°ãƒ»ç™ºé›»ãªã©' },
                    physics_balance: { title: 'åŠ›ã®ã¤ã‚Šåˆã„ã¨åˆæˆãƒ»åˆ†è§£', description: 'åŠ›ã®åˆæˆãƒ»åˆ†è§£ãƒ»ã¤ã‚Šåˆã„ãªã©' },
                    physics_motion: { title: 'ç‰©ä½“ã®é‹å‹•', description: 'ç­‰é€Ÿç›´ç·šé‹å‹•ãƒ»æ…£æ€§ã®æ³•å‰‡ãƒ»ä½œç”¨åä½œç”¨ãªã©' },
                    physics_pressure: { title: 'æ°´åœ§ã¨æµ®åŠ›', description: 'æ°´åœ§ãƒ»æµ®åŠ›ãƒ»åœ§åŠ›ãªã©' },
                    physics_work: { title: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨ä»•äº‹', description: 'é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»ä»•äº‹ãªã©' },
                    physics_energy_change: { title: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ç§»ã‚Šå¤‰ã‚ã‚Š', description: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®æ³•å‰‡ãƒ»ç†±ä¼å°ãªã©' },
                    physics_resources: { title: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼è³‡æºã®åˆ©ç”¨', description: 'åŒ–çŸ³ç‡ƒæ–™ãƒ»åŸå­åŠ›ãƒ»å†ç”Ÿå¯èƒ½ã‚¨ãƒãƒ«ã‚®ãƒ¼ãªã©' }
                }
            },
            earth: {
                title: 'ğŸŒ åœ°å­¦',
                categories: {
                    earth_volcano: { title: 'ç«å±±', description: 'ãƒã‚°ãƒãƒ»ç«æˆå²©ãƒ»ç«å±±å²©ãƒ»æ·±æˆå²©ãªã©' },
                    earth_earthquake: { title: 'åœ°éœ‡', description: 'éœ‡æºãƒ»éœ‡åº¦ãƒ»ãƒã‚°ãƒ‹ãƒãƒ¥ãƒ¼ãƒ‰ãƒ»æ–­å±¤ãƒ»æ´¥æ³¢ãªã©' },
                    earth_strata: { title: 'åœ°å±¤ã®ã§ãæ–¹', description: 'é¢¨åŒ–ãƒ»ä¾µé£Ÿãƒ»å †ç©ãƒ»åŒ–çŸ³ãƒ»åœ°è³ªå¹´ä»£ãªã©' },
                    earth_weather: { title: 'æ°—è±¡ã®è¦³æ¸¬ã€å¤§æ°—åœ§ã¨åœ§åŠ›', description: 'å¤©æ°—ãƒ»æ°—åœ§ãƒ»é«˜æ°—åœ§ãƒ»ä½æ°—åœ§ãªã©' },
                    earth_front: { title: 'æ°—å›£ã¨å‰ç·šã€æ—¥æœ¬ã®å¤©æ°—', description: 'å‰ç·šãƒ»å­£ç¯€é¢¨ãƒ»å°é¢¨ãƒ»æ¢…é›¨ãªã©' },
                    earth_cloud: { title: 'é›²ã®ã§ãæ–¹ã¨æ°´è’¸æ°—', description: 'æ¹¿åº¦ãƒ»éœ²ç‚¹ãƒ»é£½å’Œæ°´è’¸æ°—é‡ãªã©' },
                    earth_celestial: { title: 'åœ°çƒã®å‹•ãã¨å¤©ä½“ã®å‹•ã', description: 'è‡ªè»¢ãƒ»å…¬è»¢ãƒ»åœ°è»¸ãƒ»å—ä¸­ãªã©' },
                    earth_solar: { title: 'å¤ªé™½ç³»ã®å¤©ä½“', description: 'å¤ªé™½ç³»ãƒ»éŠ€æ²³ç³»ãƒ»æ’æ˜Ÿãƒ»æƒ‘æ˜Ÿãªã©' },
                    earth_moon: { title: 'æœˆã¨æƒ‘æ˜Ÿã®è¦‹ãˆæ–¹ã€è‡ªç„¶ã®æµã¿ã¨ç½å®³', description: 'æœˆé£Ÿãƒ»æ—¥é£Ÿãƒ»å†…æƒ‘æ˜Ÿãƒ»ç«å±±ç½å®³ãªã©' }
                }
            },
            words: {
                title: 'ğŸ“ è‹±å˜èª',
                categories: {
                    words_time: { title: 'æœˆãƒ»åºæ•°', description: 'January, first, secondãªã©' },
                    words_week: { title: 'æ›œæ—¥', description: 'Sunday, Monday, Tuesdayãªã©' },
                    words_timeday: { title: 'æ™‚ãƒ»æ™‚é–“å¸¯ãªã©', description: 'morning, afternoon, eveningãªã©' },
                    words_season: { title: 'å­£ç¯€ãƒ»å®¶æ—', description: 'spring, summer, family, fatherãªã©' },
                    words_sports: { title: 'ã‚¹ãƒãƒ¼ãƒ„ãƒ»æ•™ç§‘', description: 'baseball, soccer, English, mathãªã©' },
                    words_job: { title: 'è·æ¥­ãƒ»äººãƒ»å»ºç‰©ãƒ»æ–½è¨­', description: 'teacher, doctor, school, hospitalãªã©' },
                    words_uncountable: { title: 'æ•°ãˆã‚‰ã‚Œãªã„åè©', description: 'water, money, news, homeworkãªã©' },
                    words_verb_important: { title: 'å…¥è©¦å¿…å‡ºé‡è¦å‹•è©', description: 'like, play, go, come, want, studyãªã©' },
                    words_verb_various: { title: 'ã„ã‚ã„ã‚ãªæ„å‘³ã‚’ã‚‚ã¤å‹•è©', description: 'have, take, get, see, hearãªã©' },
                    words_verb_set: { title: 'ã‚»ãƒƒãƒˆã§è¦šãˆã¦ãŠããŸã„å‹•è©', description: 'ask-answer, learn-teach, buy-sellãªã©' },
                    words_verb_other: { title: 'ãã®ä»–ã®é‡è¦å‹•è©', description: 'enjoy, eat, drink, work, helpãªã©' },
                    words_adj_quantity: { title: 'æ•°ãƒ»é‡ã‚’è¡¨ã™å½¢å®¹è©', description: 'many, much, some, few, littleãªã©' },
                    words_adj_various: { title: 'ã„ã‚ã„ã‚ãªå½¢å®¹è©', description: 'good, bad, big, small, hot, coldãªã©' },
                    words_adj_adv: { title: 'ãã®ä»–ã®é‡è¦å½¢å®¹è©ãƒ»å‰¯è©', description: 'always, usually, often, well, fastãªã©' },
                    words_adv_manner: { title: 'æ§˜å­ã‚’è¡¨ã™å‰¯è©', description: 'well, fast, slowly, hard, againãªã©' }
                }
            },
            phrases: {
                title: 'ğŸ’¬ è‹±ç†Ÿèª',
                categories: {
                    phrases_verb: { title: 'ã‚ˆãå‡ºã‚‹å‹•è©ã®ç†Ÿèª', description: 'listen to, get up, go to schoolãªã©' },
                    phrases_set: { title: 'ã‚»ãƒƒãƒˆã§è¦šãˆã¦ãŠããŸã„ç†Ÿèª', description: 'stand up - sit down, get on - get offãªã©' },
                    phrases_similar: { title: 'æ„å‘³ã®ä¼¼ã¦ã„ã‚‹ç†Ÿèª', description: 'go home, come home, get homeãªã©' },
                    phrases_verb_other: { title: 'ãã®ä»–ã®å‹•è©ã®ç†Ÿèª', description: 'go shopping, go fishing, give upãªã©' },
                    phrases_be: { title: 'beå‹•è©ã‚’ä½¿ã£ãŸç†Ÿèª', description: 'be good at, be interested in, be late forãªã©' },
                    phrases_quantity: { title: 'æ•°ã‚„é‡ã‚’è¡¨ã™ç†Ÿèª', description: 'a lot of, lots of, one of, some ofãªã©' },
                    phrases_time_place: { title: 'æ™‚ãƒ»å ´æ‰€ã‚’è¡¨ã™ç†Ÿèª', description: 'next week, last Sunday, after schoolãªã©' },
                    phrases_important: { title: 'ãã®ä»–ã®é‡è¦ç†Ÿèª', description: 'over there, at home, for example, of courseãªã©' }
                }
            },
            grammar: {
                title: 'ğŸ“˜ èªå½¢å¤‰åŒ–',
                categories: {
                    grammar_irregular_past: { title: 'ä¸è¦å‰‡å‹•è© - éå»å½¢ãƒ»éå»åˆ†è©', description: 'do-did-done, go-went-goneãªã©' },
                    grammar_irregular_same: { title: 'ä¸è¦å‰‡å‹•è© - éå»å½¢ã¨éå»åˆ†è©ãŒåŒã˜', description: 'have-had-had, make-made-madeãªã©' },
                    grammar_irregular_special: { title: 'ä¸è¦å‰‡å‹•è© - ç‰¹æ®Šãªã‚±ãƒ¼ã‚¹', description: 'come-came-come, run-ran-runãªã©' },
                    grammar_be_past: { title: 'beå‹•è© - éå»å½¢ãƒ»éå»åˆ†è©', description: 'am/isâ†’was, areâ†’were, beâ†’beenãªã©' },
                    grammar_regular: { title: 'è¦å‰‡å‹•è© - éå»å½¢ãƒ»éå»åˆ†è©', description: 'helpâ†’helped, studyâ†’studiedãªã©' },
                    grammar_third_person: { title: 'ä¸‰äººç§°å˜æ•°ç¾åœ¨å½¢', description: 'giveâ†’gives, goâ†’goes, studyâ†’studiesãªã©' },
                    grammar_ing: { title: 'å‹•è©ã®-ingå½¢', description: 'makeâ†’making, runâ†’running, studyâ†’studyingãªã©' },
                    grammar_comparative: { title: 'å½¢å®¹è© - æ¯”è¼ƒç´šãƒ»æœ€ä¸Šç´š', description: 'tallâ†’tallerâ†’tallest, happyâ†’happierâ†’happiestãªã©' },
                    grammar_more_most: { title: 'moreã€mostã‚’ã¤ã‘ã‚‹å½¢å®¹è©', description: 'famousâ†’more famousâ†’most famousãªã©' },
                    grammar_noun_plural: { title: 'åè©ã®è¤‡æ•°å½¢', description: 'girlâ†’girls, boxâ†’boxes, cityâ†’citiesãªã©' },
                    grammar_irregular_plural: { title: 'ä¸è¦å‰‡ãªè¤‡æ•°å½¢', description: 'childâ†’children, manâ†’men, footâ†’feetãªã©' },
                    grammar_pronoun: { title: 'äººç§°ä»£åè©', description: 'Iâ†’myâ†’meâ†’mine, heâ†’hisâ†’himâ†’hisãªã©' }
                }
            }
        };

        // åˆæœŸåŒ–
        function init() {
            console.log('Quick QuizåˆæœŸåŒ–ä¸­...');
            
            // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
            if (typeof window.problemDatabase === 'undefined') {
                showError('å•é¡Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚problems.jsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            console.log('å•é¡Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èª­ã¿è¾¼ã¿å®Œäº†');
            updateStats();
        }

        // ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
        function showError(message) {
            const container = document.querySelector('.main-content');
            container.innerHTML = `
                <div class="error-message">
                    <h3>âš ï¸ ã‚¨ãƒ©ãƒ¼</h3>
                    <p>${message}</p>
                    <button class="btn" onclick="location.reload()">ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿</button>
                </div>
            `;
        }

        // æ•™ç§‘é¸æŠ
        function selectSubject(subject) {
            currentSubject = subject;
            hideAllSections();
            document.getElementById(`${subject}-fields`).classList.add('active');
        }

        // åˆ†é‡é¸æŠ
        function selectField(field) {
            currentField = field;
            selectedCategories = [];
            setupCategorySelection();
            hideAllSections();
            document.getElementById('category-selection').classList.add('active');
        }

        // ã‚«ãƒ†ã‚´ãƒªé¸æŠã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        function setupCategorySelection() {
            const fieldData = categoryDefinitions[currentField];
            const titleElement = document.getElementById('category-title');
            const gridElement = document.getElementById('category-grid');
            const audioSettings = document.getElementById('audio-settings');
            
            titleElement.textContent = fieldData.title;
            
            // è‹±èªã®å ´åˆã¯éŸ³å£°è¨­å®šã‚’è¡¨ç¤º
            if (currentSubject === 'english') {
                audioSettings.style.display = 'block';
            } else {
                audioSettings.style.display = 'none';
            }
            
            gridElement.innerHTML = '';
            
            Object.entries(fieldData.categories).forEach(([key, category]) => {
                // å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                if (!window.problemDatabase[key] || window.problemDatabase[key].length === 0) {
                    return; // ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
                }
                
                const categoryElement = document.createElement('div');
                categoryElement.className = 'category-item';
                categoryElement.onclick = () => toggleCategory(key, categoryElement);
                
                categoryElement.innerHTML = `
                    <h4>${category.title}</h4>
                    <p>${category.description}</p>
                    <small>${window.problemDatabase[key].length}å•</small>
                `;
                
                gridElement.appendChild(categoryElement);
            });
        }

        // ã‚«ãƒ†ã‚´ãƒªã®é¸æŠ/è§£é™¤
        function toggleCategory(categoryId, element) {
            const index = selectedCategories.indexOf(categoryId);
            if (index === -1) {
                selectedCategories.push(categoryId);
                element.classList.add('selected');
            } else {
                selectedCategories.splice(index, 1);
                element.classList.remove('selected');
            }
            
            const startBtn = document.getElementById('start-btn');
            startBtn.disabled = selectedCategories.length === 0;
        }

        // ã‚¯ã‚¤ã‚ºé–‹å§‹
        function startQuiz() {
            if (selectedCategories.length === 0) {
                alert('å°‘ãªãã¨ã‚‚1ã¤ã®ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            // é¸æŠã•ã‚ŒãŸã‚«ãƒ†ã‚´ãƒªã‹ã‚‰å•é¡Œã‚’åé›†
            currentProblems = [];
            selectedCategories.forEach(categoryId => {
                if (window.problemDatabase[categoryId]) {
                    window.problemDatabase[categoryId].forEach(problem => {
                        currentProblems.push({
                            ...problem,
                            category: categoryId
                        });
                    });
                }
            });
            
            if (currentProblems.length === 0) {
                alert('é¸æŠã•ã‚ŒãŸã‚«ãƒ†ã‚´ãƒªã«å•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“ã€‚');
                return;
            }
            
            // å•é¡Œã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
            currentProblems = shuffleArray(currentProblems);
            currentProblemIndex = 0;
            
            // çµ±è¨ˆã‚’ãƒªã‚»ãƒƒãƒˆ
            stats = { correct: 0, incorrect: 0, total: 0 };
            updateStats();
            
            hideAllSections();
            document.getElementById('quiz-section').classList.add('active');
            
            showNextQuestion();
        }

        // é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // æ¬¡ã®å•é¡Œã‚’è¡¨ç¤º
        function showNextQuestion() {
            if (currentProblemIndex >= currentProblems.length) {
                // å•é¡Œã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¦æœ€åˆã‹ã‚‰
                currentProblems = shuffleArray(currentProblems);
                currentProblemIndex = 0;
            }
            
            currentProblem = currentProblems[currentProblemIndex];
            displayQuestion();
            hideResult();
        }

        // å•é¡Œã‚’è¡¨ç¤º
        function displayQuestion() {
            const questionText = document.getElementById('question-text');
            const optionsContainer = document.getElementById('options-container');
            const audioControls = document.getElementById('audio-controls');
            
            questionText.textContent = currentProblem.q;
            
            // è‹±èªã®å•é¡Œã®å ´åˆã¯éŸ³å£°ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è¡¨ç¤º
            if (currentSubject === 'english' && document.getElementById('audioEnabled').checked) {
                audioControls.style.display = 'block';
                // è‡ªå‹•ã§å•é¡Œã‚’èª­ã¿ä¸Šã’
                setTimeout(() => speakQuestion(), 500);
            } else {
                audioControls.style.display = 'none';
            }
            
            // é¸æŠè‚¢ã‚’è¡¨ç¤º
            optionsContainer.innerHTML = '';
            currentProblem.opts.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                optionElement.onclick = () => selectOption(index, optionElement);
                optionsContainer.appendChild(optionElement);
            });
        }

        // é¸æŠè‚¢ã‚’é¸æŠ
        function selectOption(index, element) {
            // ä»–ã®é¸æŠã‚’è§£é™¤
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // é¸æŠã—ãŸé¸æŠè‚¢ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            element.classList.add('selected');
            
            // å°‘ã—å¾…ã£ã¦ã‹ã‚‰çµæœã‚’è¡¨ç¤º
            setTimeout(() => checkAnswer(index), 300);
        }

        // å›ç­”ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦AIè§£èª¬ã‚’è¡¨ç¤º
        async function checkAnswer(selectedIndex) {
            const isCorrect = selectedIndex === currentProblem.ans;
            const correctAnswer = currentProblem.opts[currentProblem.ans];
            
            // çµ±è¨ˆã‚’æ›´æ–°
            if (isCorrect) {
                stats.correct++;
            } else {
                stats.incorrect++;
            }
            stats.total++;
            updateStats();
            
            // AIã«ã‚ˆã‚‹è©³ã—ã„è§£èª¬ã‚’å–å¾—ã—ã¦è¡¨ç¤º
            await showResultWithAI(isCorrect, correctAnswer, selectedIndex);
            
            currentProblemIndex++;
        }

        // AIè§£èª¬ä»˜ãã§çµæœã‚’è¡¨ç¤º
        async function showResultWithAI(isCorrect, correctAnswer, selectedIndex) {
            const result = document.getElementById('result');
            const selectedAnswer = currentProblem.opts[selectedIndex];
            
            // ã¾ãšåŸºæœ¬çš„ãªçµæœã‚’è¡¨ç¤º
            if (isCorrect) {
                result.className = 'result correct';
                result.innerHTML = `
                    <h3>ğŸ‰ æ­£è§£ã§ã™ï¼ç´ æ™´ã‚‰ã—ã„ï¼</h3>
                    <p><strong>æ­£è§£ï¼š</strong> ${correctAnswer}</p>
                    <p><strong>åŸºæœ¬è§£èª¬ï¼š</strong> ${currentProblem.exp}</p>
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>AIå…ˆç”ŸãŒè©³ã—ã„è§£èª¬ã‚’æº–å‚™ä¸­...</p>
                    </div>
                `;
            } else {
                result.className = 'result incorrect';
                result.innerHTML = `
                    <h3>âŒ ä¸æ­£è§£ã§ã™</h3>
                    <p><strong>ã‚ãªãŸã®å›ç­”ï¼š</strong> ${selectedAnswer}</p>
                    <p><strong>æ­£è§£ï¼š</strong> ${correctAnswer}</p>
                    <p><strong>åŸºæœ¬è§£èª¬ï¼š</strong> ${currentProblem.exp}</p>
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>AIå…ˆç”ŸãŒè©³ã—ã„è§£èª¬ã‚’æº–å‚™ä¸­...</p>
                    </div>
                `;
            }
            
            result.style.display = 'block';
            
            // AIã«ã‚ˆã‚‹è©³ã—ã„è§£èª¬ã‚’å–å¾—
            try {
                const aiExplanation = await getAIExplanation({
                    question: currentProblem.q,
                    correctAnswer: correctAnswer,
                    selectedAnswer: selectedAnswer,
                    explanation: currentProblem.exp,
                    options: currentProblem.opts,
                    isCorrect: isCorrect,
                    category: getCategoryTitle(currentProblem.category),
                    subject: getCurrentSubjectTitle()
                });
                
                // AIè§£èª¬ã‚’è¡¨ç¤º
                const loadingDiv = result.querySelector('.loading');
                if (loadingDiv) {
                    loadingDiv.outerHTML = `
                        <div class="ai-explanation">
                            <h4>ğŸ¤– AIå…ˆç”Ÿã®è©³ã—ã„è§£èª¬</h4>
                            <div class="ai-content">${aiExplanation}</div>
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error('AIè§£èª¬ã®å–å¾—ã«å¤±æ•—:', error);
                const loadingDiv = result.querySelector('.loading');
                if (loadingDiv) {
                    loadingDiv.outerHTML = `
                        <div class="ai-explanation">
                            <h4>ğŸ“– è©³ã—ã„è§£èª¬</h4>
                            <div class="ai-content">ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚AIè§£èª¬ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚åŸºæœ¬è§£èª¬ã‚’ã”å‚ç…§ãã ã•ã„ã€‚</div>
                        </div>
                    `;
                }
            }
        }

        // AIè§£èª¬ã‚’å–å¾—
        async function getAIExplanation(problemData) {
            // APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆ
            if (!DIFY_API_KEY || DIFY_API_KEY === 'YOUR_DIFY_API_KEY') {
                return `ã“ã®å•é¡Œã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã„ãŸã—ã¾ã™ã€‚

ã€å•é¡Œã®è§£èª¬ã€‘
${problemData.explanation}

ã€è¦šãˆæ–¹ã®ã‚³ãƒ„ã€‘
ã“ã®åˆ†é‡ï¼ˆ${problemData.category}ï¼‰ã¯ã€åŸºæœ¬çš„ãªçŸ¥è­˜ã‚’ä½“ç³»çš„ã«æ•´ç†ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

ã€é–¢é€£çŸ¥è­˜ã€‘
${problemData.subject}ã®å­¦ç¿’ã§ã¯ã€æ¦‚å¿µåŒå£«ã®ã¤ãªãŒã‚Šã‚’æ„è­˜ã™ã‚‹ã“ã¨ã§ç†è§£ãŒæ·±ã¾ã‚Šã¾ã™ã€‚

ã€ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘
${problemData.isCorrect ? 
'ç´ æ™´ã‚‰ã—ã„æ­£è§£ã§ã™ï¼ã“ã®èª¿å­ã§ä»–ã®å•é¡Œã«ã‚‚æŒ‘æˆ¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚' : 
'é–“é•ã„ã‚’æã‚Œãšã«å­¦ç¿’ã‚’ç¶šã‘ã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚æ­£è§£ã®ç†ç”±ã‚’ç†è§£ã—ã¦æ¬¡ã«æ´»ã‹ã—ã¾ã—ã‚‡ã†ã€‚'}`;
            }
            
            const prompt = createPromptForProblem(problemData);
            
            try {
                const response = await fetch(DIFY_API_URL, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${DIFY_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        inputs: {},
                        query: prompt,
                        response_mode: 'blocking',
                        conversation_id: '',
                        user: 'quiz-user'
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                return data.answer || problemData.explanation;
                
            } catch (error) {
                console.error('Dify API ã‚¨ãƒ©ãƒ¼:', error);
                throw error;
            }
        }

        // AIç”¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½œæˆ
        function createPromptForProblem(problemData) {
            const { question, correctAnswer, selectedAnswer, explanation, isCorrect, category, subject } = problemData;
            
            if (isCorrect) {
                return `ä¸­å­¦ç”Ÿå‘ã‘${subject}ã®ã‚¯ã‚¤ã‚ºã§æ­£è§£ã—ãŸå•é¡Œã«ã¤ã„ã¦ã€ã•ã‚‰ã«è©³ã—ãè§£èª¬ã—ã¦ãã ã•ã„ã€‚

ã€å•é¡Œã€‘${question}
ã€æ­£è§£ã€‘${correctAnswer}
ã€åŸºæœ¬è§£èª¬ã€‘${explanation}
ã€åˆ†é‡ã€‘${category}

ä»¥ä¸‹ã®å†…å®¹ã‚’å«ã‚ã¦ã€ä¸­å­¦ç”Ÿã«ã‚‚åˆ†ã‹ã‚Šã‚„ã™ãè©³ã—ãè§£èª¬ã—ã¦ãã ã•ã„ï¼š
1. ãªãœãã®ç­”ãˆãŒæ­£ã—ã„ã®ã‹ã®è©³ã—ã„ç†ç”±
2. è¦šãˆæ–¹ã‚„ã‚³ãƒ„
3. é–¢é€£ã™ã‚‹çŸ¥è­˜ã‚„æ¦‚å¿µ
4. å®Ÿç”Ÿæ´»ã§ã®å¿œç”¨ä¾‹ãŒã‚ã‚Œã°

åŠ±ã¾ã—ã®è¨€è‘‰ã‚‚å«ã‚ã¦ã€èˆˆå‘³ã‚’æŒã£ã¦å­¦ç¿’ã‚’ç¶šã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ãªè§£èª¬ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚`;
            } else {
                return `ä¸­å­¦ç”Ÿå‘ã‘${subject}ã®ã‚¯ã‚¤ã‚ºã§é–“é•ãˆãŸå•é¡Œã«ã¤ã„ã¦ã€è©³ã—ãè§£èª¬ã—ã¦ãã ã•ã„ã€‚

ã€å•é¡Œã€‘${question}
ã€é¸ã‚“ã ç­”ãˆã€‘${selectedAnswer}
ã€æ­£è§£ã€‘${correctAnswer}
ã€åŸºæœ¬è§£èª¬ã€‘${explanation}
ã€åˆ†é‡ã€‘${category}

ä»¥ä¸‹ã®å†…å®¹ã‚’å«ã‚ã¦ã€ä¸­å­¦ç”Ÿã«ã‚‚åˆ†ã‹ã‚Šã‚„ã™ãè©³ã—ãè§£èª¬ã—ã¦ãã ã•ã„ï¼š
1. æ­£ã—ã„ç­”ãˆã®è©³ã—ã„ç†ç”±
2. ãªãœé–“é•ãˆã‚„ã™ã„ã®ã‹ã€ã‚ˆãã‚ã‚‹å‹˜é•ã„
3. æ­£è§£ã‚’å°ããŸã‚ã®ãƒã‚¤ãƒ³ãƒˆã‚„è¦šãˆæ–¹
4. é–¢é€£ã™ã‚‹çŸ¥è­˜

é–“é•ã„ã‚’æã‚Œãšã«å­¦ç¿’ã‚’ç¶šã‘ã‚‹ã“ã¨ã®å¤§åˆ‡ã•ã‚‚ä¼ãˆã¦ã€æ¬¡ã¯æ­£è§£ã§ãã‚‹ã‚ˆã†åŠ±ã¾ã—ã®è¨€è‘‰ã‚‚å«ã‚ã¦ãã ã•ã„ã€‚`;
            }
        }

        // ã‚«ãƒ†ã‚´ãƒªã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—
        function getCategoryTitle(categoryId) {
            for (const field of Object.values(categoryDefinitions)) {
                if (field.categories[categoryId]) {
                    return field.categories[categoryId].title;
                }
            }
            return categoryId;
        }

        // ç¾åœ¨ã®æ•™ç§‘ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—
        function getCurrentSubjectTitle() {
            const fieldData = categoryDefinitions[currentField];
            return fieldData ? fieldData.title : 'å­¦ç¿’';
        }

        // çµæœã‚’éè¡¨ç¤º
        function hideResult() {
            document.getElementById('result').style.display = 'none';
        }

        // æ¬¡ã®å•é¡Œã¸
        function nextQuestion() {
            showNextQuestion();
        }

        // çµ±è¨ˆã‚’æ›´æ–°
        function updateStats() {
            document.getElementById('correct-count').textContent = stats.correct;
            document.getElementById('incorrect-count').textContent = stats.incorrect;
            document.getElementById('total-count').textContent = stats.total;
        }

        // éŸ³å£°èª­ã¿ä¸Šã’æ©Ÿèƒ½
        function speakQuestion() {
            if (currentSubject !== 'english' || !currentProblem) return;
            
            const text = currentProblem.q;
            const voice = document.querySelector('input[name="voice"]:checked').value;
            speak(text, voice);
        }

        function speakOptions() {
            if (currentSubject !== 'english' || !currentProblem) return;
            
            const text = currentProblem.opts.join(', ');
            const voice = document.querySelector('input[name="voice"]:checked').value;
            speak(text, voice);
        }

        function speak(text, voiceType) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                
                const voices = speechSynthesis.getVoices();
                const preferredVoice = voices.find(voice => 
                    voiceType === 'female' ? 
                    voice.name.toLowerCase().includes('female') || voice.name.toLowerCase().includes('samantha') :
                    voice.name.toLowerCase().includes('male') || voice.name.toLowerCase().includes('daniel')
                );
                
                if (preferredVoice) {
                    utterance.voice = preferredVoice;
                }
                
                speechSynthesis.speak(utterance);
            }
        }

        // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³é–¢æ•°
        function hideAllSections() {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
        }

        function goBack(sectionId) {
            hideAllSections();
            document.getElementById(sectionId).classList.add('active');
        }

        function goBackToSubject() {
            hideAllSections();
            document.getElementById(`${currentSubject}-fields`).classList.add('active');
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        window.addEventListener('DOMContentLoaded', init);

        // éŸ³å£°åˆæˆã®æº–å‚™
        window.addEventListener('load', () => {
            if ('speechSynthesis' in window) {
                speechSynthesis.getVoices();
            }
        });
    </script>
</body>
</html>